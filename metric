import re

def normalize_query(query):
    # Add your normalization logic here
    # This example handles 'WHERE' conditions with 'AND', 'OR', 'BETWEEN', and '=' operators
    
    # Extract conditions from the query
    conditions_match = re.search(r'WHERE (.+)$', query)
    
    if conditions_match:
        conditions = conditions_match.group(1)
        
        # Split conditions based on 'AND', 'OR'
        conditions_list = re.split(r'\bAND\b|\bOR\b', conditions)
        
        # Normalize and sort conditions
        normalized_conditions = []
        for condition in conditions_list:
            if 'BETWEEN' in condition:
                # Normalize 'BETWEEN' conditions by sorting the range values
                normalized_condition = 'BETWEEN ' + ' AND '.join(sorted(re.findall(r'\d+', condition)))
            else:
                # For other conditions, normalize by sorting
                normalized_condition = ' '.join(sorted(re.findall(r'\S+', condition)))

            normalized_conditions.append(normalized_condition)
        
        # Reconstruct the normalized query
        normalized_query = re.sub(r'WHERE (.+)$', 'WHERE ' + ' AND '.join(normalized_conditions), query)
        return normalized_query
    else:
        # If there's no WHERE clause, return the original query
        return query

# Rest of the code remains the same

# Example usage:
predicted_queries = [
    "SELECT * FROM table1 WHERE column1 = 'value1' AND column2 = 'value2'",
    "SELECT * FROM table1 WHERE column2 = 'value2' AND column1 = 'value1'",
    "SELECT * FROM table1 WHERE column3 BETWEEN 10 AND 20"
]
true_queries = [
    "SELECT * FROM table1 WHERE column1 = 'value1' AND column2 = 'value2'",
    "SELECT * FROM table1 WHERE column2 = 'value2' AND column1 = 'value1'",
    "SELECT * FROM table1 WHERE column3 BETWEEN 20 AND 10"
]

precision, recall, f1_score = calculate_metrics(predicted_queries, true_queries)

print("Precision:", precision)
print("Recall:", recall)
print("F1 Score:", f1_score)

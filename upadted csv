import pandas as pd
import pandasql as psql

# Sample data for the first CSV ('queries.csv')
queries_data = {
    'predicted_queries': [
        'SELECT * FROM actual_data WHERE age > 25',
        'SELECT name, age FROM actual_data WHERE city = "New York"',
        'SELECT MAX(salary) FROM actual_data WHERE department = "Sales"'
    ],
    'true_queries': [
        'SELECT * FROM actual_data WHERE age > 25',
        'SELECT name, age FROM actual_data WHERE city = "New York"',
        'SELECT MAX(salary) FROM actual_data WHERE department = "Sales"'
    ]
}

# Create a DataFrame for the first CSV
queries_df = pd.DataFrame(queries_data)

# Sample data for the second CSV ('actual_data.csv')
actual_data = {
    'id': [1, 2, 3, 4, 5],
    'name': ['John', 'Alice', 'Bob', 'Emily', 'Charlie'],
    'age': [28, 32, 25, 35, 29],
    'city': ['New York', 'Los Angeles', 'Chicago', 'San Francisco', 'Boston'],
    'salary': [75000, 80000, 70000, 90000, 85000],
    'department': ['Sales', 'Marketing', 'IT', 'HR', 'Finance']
}

# Create a DataFrame for the actual data
actual_df = pd.DataFrame(actual_data)

# Convert actual_df to a dictionary
actual_data_dict = actual_df.to_dict(orient='split')

# Iterate through each row of the first CSV and execute the queries
for index, row in queries_df.iterrows():
    predicted_query = row['predicted_queries']
    true_query = row['true_queries']

    # Execute the predicted query
    predicted_result_df = psql.sqldf(predicted_query, {'df': actual_data_dict})

    # Execute the true query
    true_result_df = psql.sqldf(true_query, {'df': actual_data_dict})

    # Check if the results are similar
    if predicted_result_df.equals(true_result_df):
        print(f"Row {index + 1}: Results are similar")
    else:
        print(f"Row {index + 1}: Results are different")
